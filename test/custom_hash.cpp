#include <catch2/catch.hpp>

#include <mdbg/hash.hpp>

#include <vector>
#include <cstdint>

::std::vector<::std::uint64_t> extern sequence;

TEST_CASE("Basic", "[128 bit hash]") {
  for (::std::size_t k = 1; k < ::sequence.size(); ++k) {
    ::mdbg::hash128 hash{
      ::sequence.begin(),
      ::sequence.begin() + static_cast<long>(k)
    };

    for (::std::size_t i = k; i < ::sequence.size(); ++i) {
      hash.rotate(::sequence[i], ::sequence[i - k], k);
      REQUIRE(hash == ::mdbg::hash128{
        ::sequence.begin() + static_cast<long>(i - k) + 1,
        ::sequence.begin() + static_cast<long>(i) + 1
      });
    }
  }
}

// sequence.size() > 128
::std::vector<::std::uint64_t> sequence{
  2183138153721051810ull,
  3834487758385133249ull,
  2670108792844243639ull,
  4100114510284609398ull,
  601835427138959155ull,
  1495799109973982924ull,
  860238163842074900ull,
  2110129445070425812ull,
  24825585923753915ull,
  254703531907888584ull,
  4150868620930119192ull,
  3786458251808967220ull,
  920924912191377571ull,
  1486659697365050352ull,
  1806830690012078913ull,
  590408451756340744ull,
  1734109677606880320ull,
  2748644005395479115ull,
  2874566893786155769ull,
  3663547429877029104ull,
  1400377528793130139ull,
  2723970348539529527ull,
  4394281433786323695ull,
  91000837400189905ull,
  2004406313227693253ull,
  962596384197310928ull,
  1575041067200231925ull,
  872268019669952247ull,
  4219326369349185889ull,
  1213537683932519794ull,
  2731367913618254062ull,
  4563610191990125833ull,
  4126335727215987465ull,
  4512155443184795963ull,
  2666058004919285140ull,
  992338546492326431ull,
  401926069669870690ull,
  655039339110661890ull,
  3886305160069756895ull,
  485262490952826271ull,
  4163365053620070005ull,
  1624083632460222927ull,
  1650680971318382912ull,
  4339661973722529157ull,
  2545943088372670254ull,
  1766523575444976978ull,
  1178773666711709125ull,
  2021218275968941487ull,
  1750436835132279048ull,
  1342549271152043035ull,
  3445605628228269772ull,
  3773862815696173693ull,
  3538011791989698681ull,
  1203349898196215544ull,
  1682059263337678976ull,
  3070996127020595563ull,
  1074140393938488571ull,
  3613868271934251016ull,
  496133495593602090ull,
  4301660648973248683ull,
  4572664926789157918ull,
  4393296007285876067ull,
  2991705840128551505ull,
  2074930521134121420ull,
  2809076184209615516ull,
  3263429304611971854ull,
  2587091451878835024ull,
  1870538661783713710ull,
  4483177932105662679ull,
  2539589726672058967ull,
  1889503343244909694ull,
  4471943662255625520ull,
  2325934276017120211ull,
  490428184865323679ull,
  3424520913137647750ull,
  3422257498243555352ull,
  888259098257742324ull,
  3802325887615120265ull,
  1842885412433549806ull,
  259944259408025605ull,
  795201642101049876ull,
  1318071656433421250ull,
  2976786065504286588ull,
  1688291702207164213ull,
  2973152123816593043ull,
  4081420767707858242ull,
  1141628891920788559ull,
  2836398776346081158ull,
  605843767537677895ull,
  1049611511872200284ull,
  1033571214328478314ull,
  3425284447516623643ull,
  1686319710620567608ull,
  2882526236917180310ull,
  1539358594136772349ull,
  2555179801156373154ull,
  1668796450034631610ull,
  3390927368332824410ull,
  733596730984936702ull,
  802761117142958993ull,
  164173792853266176ull,
  3352960791499103827ull,
  606353571511041208ull,
  4395090336108026197ull,
  1137456731712177683ull,
  2983579032314670001ull,
  152219187663068308ull,
  443420053923891646ull,
  4206541435799842481ull,
  3199557832215408390ull,
  2028972347333432284ull,
  3605913932824107749ull,
  3900827874953224224ull,
  371438640250373407ull,
  652425124863297370ull,
  87118894907904050ull,
  3504792902762215201ull,
  554972446231018600ull,
  1312936312373314395ull,
  2102415211057489051ull,
  4235567318871268071ull,
  3299575709955234542ull,
  838829634599267447ull,
  3782671720005265607ull,
  2116989518394442579ull,
  4449467315328392695ull,
  3187382152307806277ull,
  4568051517140134870ull,
  4190772621570868369ull,
  9584152830027893ull,
  4040787581588855198ull,
  3390776384702006744ull,
  1065767870626109474ull,
  3879329669929265547ull,
  934484648074127792ull,
  3162404769844317179ull,
  916683175031564459ull,
  1943764082550601151ull,
  1345316384931149068ull,
  1785893594374004540ull,
  130404420789834971ull,
  3967022425581896821ull,
  2134984752862378120ull,
  1913312513669835021ull,
  332609096423774593ull,
  1462104504022291240ull,
  176776116819855849ull,
  562162418849691735ull,
  7954666997775658ull,
  4427167732934661207ull,
};
